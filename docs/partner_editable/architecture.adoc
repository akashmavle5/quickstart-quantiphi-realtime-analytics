Deploying this Quick Start with default parameters builds the following {partner-product-name} environment in the AWS Cloud.

// Replace this example diagram with your own. Send us your source PowerPoint file. Be sure to follow our guidelines here : http://(we should include these points on our contributors guide)
:xrefstyle: short
[#architecture1]
.Quick Start architecture for {partner-product-name} on AWS
[link=images/quantiphi-real-time-analytics-architecture-diagram.png]
image::../images/quantiphi-real-time-analytics-architecture-diagram.png[Architecture,width=100%,height=100%]

As shown in the <<architecture1>>, the Quick Start sets up the infrastructure as described below, along with the call flow:


. The call stream between customer and the agent / provider is received from PBX to Amazon Chime Voice Connector in two different streams.

. The chime voice connector streams the audio streams into Kinesis Video Streams.

. The streams of the two speakers trigger the two eventbridge rules simultaneously.

. Each event bridge writes the call metadata and the stream details into the respective SQS queues at the start and the end of the call.

. These messages in SQS queue (ChimeVoiceConnectorStreaming1), triggers the Transcription lambda (LiveCallsTranscriberFunction) function. This lambda function reads the audio streams from Kinesis and makes a call to Amazon Transcribe.

. The Transcription Lambda also writes the transcript data into the DynamoDB table (LiveCallsTranscriptionTable) and publishes a message to post processing SQS Queue (TranscribeResultsStreaming). This lambda also stores the mp3 file after call completion to the s3 bucket.

. Post processing SQS triggers the post processing Lambda (KeywordExtractionFunction) function. Here the transcripts are cleaned and key words are extracted using string matching. The results are stored into a DynamoDB table (KeywordExtractionTable).

. Post processing Lambda also publishes the transcripts and the keyword data to the Customer User Interface via the websocket.

. When the call ends, a SQS message is sent for both the streams through the eventbridge rule. A metadata Lambda (PublishCallMetadataFunction) function will be triggered by this SQS queue (ChimeVoiceConnectorStreaming2). This Lambda function extract the entities from the transcripts using custom entity extraction logic and Amazon Comprehend.  It notifies the frontend that the call has ended and publishes the entity metadata to the websocket and stores the data into the DynamoDB table (LiveCallsMetadataTable).



[start=1]
* Amazon Chime Voice Connector to receive agent and customer streams of a support call from Private Branch Exchange (PBX) software, and route them to Amazon Kinesis Video Streams. 
* Two Amazon EventBridge rules, both triggered simultaneously on the receipt of call streams. They write call metadata and stream details into Amazon Simple Queue Service (Amazon SQS) queues at the start and end of the call.
* Amazon SQS queues
** SQS queue ChimeVoiceConnectorStreaming1 to initiate a transcription Lambda function.
** SQS queue ChimeVoiceConnectorStreaming2 to initiate a metadata Lambda function.
** Post-processing SQS queue TranscribeResultsStreaming to initiate a post-processing Lambda function.
* AWS Lambda functions
** Transcription function (LiveCallsTranscriberFunction) to do the following:
*** Read audio streams from Kinesis Video Streams and to call Amazon Transcribe.
*** Write transcription data into an Amazon Dynamo DB table (LiveCallsTranscriptionTable).
*** Publish a message to a post-processing SQS queue.
*** Store call in mp3 format to an Amazon Simple Storage Service (Amazon S3) bucket.
** Metadata function (PublishCallMetadataFunction) to extract entities from transcripts using custom entity extraction logic and Amazon Comprehend. 
** Post-processing function (KeywordExtractionFunction) to do the following:
*** Extract keywords from transcripts using string matching.
*** Store results of keyword extraction to a Dynamo DB table (KeywordExtractionTable).
*** Publish transcripts and keyword data to the web application through Amazon API Gateway.
* Amazon Transcribe …
* Amazon Dynamo DB …
* Amazon S3 bucket …
* Amazon API Gateways with WebSocket API ...
* A virtual private cloud (VPC) to provide you with your own virtual network on AWS.*
* In the VPC:
** Application Load Balancer …
** 1-4 Amazon Elastic Compute Cloud (Amazon EC2) instances of the web application that displays transcripts and analysis to agents. Each instance is deployed into its own private subnet (not shown).
* AWS Identity and Access Management (IAM) to manage S3 bucket access policy. 

[.small]#*The template that deploys the Quick Start into an existing VPC skips the components marked by asterisks and prompts you for your existing VPC configuration.#